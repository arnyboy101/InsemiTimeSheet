'use strict';

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _reactTestRenderer = require('react-test-renderer');

var _reactTestRenderer2 = _interopRequireDefault(_reactTestRenderer);

var _ = require('../');

var _2 = _interopRequireDefault(_);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

describe('Stopwatch', function () {
  it('renders correctly', function () {
    var stopwatch = _reactTestRenderer2.default.create(_react2.default.createElement(_2.default, {
      seconds: 0,
      minutes: 0,
      hours: 0,
      limit: '00:00:10',
      withLoop: true
      // eslint-disable-next-line no-console
      , onCallback: function onCallback() {
        return console.log('Finish');
      }
    }));

    expect(stopwatch.toJSON()).toMatchSnapshot();
  });

  it('should start to works', function (done) {
    var stopwatch = _reactTestRenderer2.default.create(_react2.default.createElement(_2.default, {
      seconds: 0,
      minutes: 0,
      hours: 0,
      limit: '00:00:10',
      withLoop: true
      // eslint-disable-next-line no-console
      , onCallback: function onCallback() {
        return console.log('Finish');
      }
    }));

    var stopwatchInstance = stopwatch.getInstance();

    expect(stopwatchInstance.state.stateHours).toBe(0);
    expect(stopwatchInstance.state.stateMinutes).toBe(0);
    expect(stopwatchInstance.state.stateSeconds).toBe(0);

    setTimeout(function () {
      expect(stopwatchInstance.state.stateSeconds).toBe(1);
      done();
    }, 1100);
  });

  it('should call to onCallback function', function (done) {
    var onFinish = function onFinish() {
      expect(true).toBe(true);
      done();
    };

    _reactTestRenderer2.default.create(_react2.default.createElement(_2.default, {
      seconds: 0,
      minutes: 0,
      hours: 0,
      limit: '00:00:03',
      withLoop: false,
      onCallback: onFinish
    }));
  });

  it('should dont make a loop if withLoop is false ', function (done) {
    var stopwatch = _reactTestRenderer2.default.create(_react2.default.createElement(_2.default, {
      seconds: 0,
      minutes: 0,
      hours: 0,
      limit: '00:00:02',
      withLoop: false
    }));

    var stopwatchInstance = stopwatch.getInstance();
    setTimeout(function () {
      expect(stopwatchInstance.state.stateSeconds).toBe(2);
      done();
    }, 2100);
  });

  it('should change to 1 minute', function (done) {
    var stopwatch = _reactTestRenderer2.default.create(_react2.default.createElement(_2.default, {
      seconds: 58,
      minutes: 0,
      hours: 0,
      limit: '00:01:00',
      withLoop: false
    }));

    var stopwatchInstance = stopwatch.getInstance();
    setTimeout(function () {
      expect(stopwatchInstance.state.stateMinutes).toBe(1);
      done();
    }, 2100);
  });

  it('should change to 1 hour', function (done) {
    var stopwatch = _reactTestRenderer2.default.create(_react2.default.createElement(_2.default, {
      seconds: 58,
      minutes: 59,
      hours: 0,
      limit: '01:00:00',
      withLoop: false
    }));

    var stopwatchInstance = stopwatch.getInstance();
    setTimeout(function () {
      expect(stopwatchInstance.state.stateHours).toBe(1);
      done();
    }, 2100);
  });
});